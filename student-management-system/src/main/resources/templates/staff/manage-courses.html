<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Manage Courses</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="p-6 bg-gray-100">
<a href="/staff/dashboard" class="mt-6 inline-block text-blue-600 hover:underline">â¬… Back to Dashboard</a>
<h1 class="text-2xl font-bold mb-6 text-center">Manage Courses</h1>

<!-- Assign Course Section -->
<div class="mb-5">
    <h2 class="text-xl font-semibold mb-2">Assign New Course</h2>


    <!-- Semester Filter Form -->
    <form method="get" action="/staff/courses" class="mb-4" id="semesterFilterForm">
        <label for="semester" class="block text-sm font-medium text-gray-700 mb-2">Filter by Semester:</label>
        <select id="semester" name="semester"
                class="w-full p-2 border rounded mb-4"
                onchange="this.form.submit()">
            <option value="">-- All Semesters --</option>
            <option th:each="sem : ${semesters}"
                    th:value="${sem}"
                    th:selected="${sem == selectedSemester}"
                    th:text="${sem}"></option>
        </select>
    </form>



    <form action="/staff/assignCourse" method="post" class="bg-white p-4 rounded shadow">
        <label for="courseId" class="block mb-2 text-sm font-medium text-gray-700">Select Course:</label>
        <select name="courseId" id="courseId" class="w-full p-2 border rounded">
            <option value="">-- Select --</option>
            <option th:each="course : ${courses}"
                    th:value="${course.id}"
                    th:data-semester="${course.semester}"
                    th:text="${course.name}">
            </option>
        </select>
        <button type="submit" class="mt-4 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">
            Assign Course
        </button>
    </form>
</div>




<!-- Assigned Courses List -->
<div>
    <h2 class="text-xl font-semibold mt-8 mb-2">Assigned Courses</h2>

    <ul class="space-y-2">
        <li th:each="course : ${assignedCourses}" class="bg-white p-4 rounded shadow">
            <div class="flex justify-between items-center">
                <div>
                    <h3 class="font-bold text-lg" th:text="${course.name}"></h3>
                    <p class="text-sm text-gray-600" th:text="'Code: ' + ${course.code}"></p>
                    <p class="text-sm text-gray-500" th:text="'Semester: ' + ${course.semester}"></p>
                </div>
                <a th:href="@{'/staff/students'(courseId=${course.id})}"
                   class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
                    View Students
                </a>
            </div>
        </li>
    </ul>

</div>




<script>
    function filterCoursesBySemester() {
        const semester = document.getElementById("semester").value;
        const courseSelect = document.getElementById("courseId");
        const options = courseSelect.querySelectorAll("option[data-semester]");

        options.forEach(opt => {
            if (!semester || opt.getAttribute("data-semester") === semester) {
                opt.style.display = "block";
            } else {
                opt.style.display = "none";
            }
        });

        courseSelect.value = "";
    }
</script>
</body>
</html>
